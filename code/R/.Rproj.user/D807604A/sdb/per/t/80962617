{
    "contents" : "rm(list=ls())\n\nlibrary(fields)\nlibrary(geoR)\nlibrary(mvtnorm)\nlibrary(evd)\n\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n\nset.seed(2087)\n\n# data settings\ns <- cbind(runif(50), runif(50))\nns <- nrow(s)\nnt <- 30\nnsets <- 1\nnknots <- 1\n\nx <- array(1, c(ns, nt, 3))\nfor (t in 1:nt) {\n    x[, t, 2] <- s[, 1]\n    x[, t, 3] <- s[, 2]\n}\n\nbeta.t <- c(0, 0, 0)\nsigma.t <- vector(mode=\"list\", length=4)\nfor (i in 1:4) {\n  sigma.t[[i]] <- 1 / rgamma(nt, 4, 4)\n  # sigma.t[[i]] <- rep(1, nt)\n}\n\nrho.t <- 0.1\nnu.t <- 0.5\nalpha.t <- 1\n\n# making sure the data generated looks reasonable\ny         <- vector(mode=\"list\", length=4)\nz.knots.t <- vector(mode=\"list\", length=4)\nz.sites.t <- vector(mode=\"list\", length=4)\nknots.t   <- vector(mode=\"list\", length=4)\ndelta.t   <- c(0, 0.5, 0.9, 0.95)\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t[[1]], \n                    delta=delta.t[1], rho=rho.t, nu=nu.t, alpha=alpha.t)          \ny[[1]] <- data$y\nz.knots.t[[1]] <- data$z.knots\nz.sites.t[[1]] <- data$z.sites\nknots.t[[1]] <- data$knots\n# hist(y[[1]], main=\"delta = 0\")\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t[[2]], \n                    delta=delta.t[2], rho=rho.t, nu=nu.t, alpha=alpha.t)          \ny[[2]] <- data$y\nz.knots.t[[2]] <- data$z.knots\nz.sites.t[[2]] <- data$z.sites\nknots.t[[2]] <- data$knots\n# hist(y[[2]], main=\"delta = 0.5\")\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t[[3]], \n                    delta=delta.t[3], rho=rho.t, nu=nu.t, alpha=alpha.t)\ny[[3]] <- data$y\nz.knots.t[[3]] <- data$z.knots\nz.sites.t[[3]] <- data$z.sites\nknots.t[[3]] <- data$knots\n# hist(y[[3]], main=\"delta = 0.9\")\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t[[4]], \n                    delta=delta.t[4], rho=rho.t, nu=nu.t, alpha=alpha.t)\ny[[4]] <- data$y\nz.knots.t[[4]] <- data$z.knots\nz.sites.t[[4]] <- data$z.sites\nknots.t[[4]] <- data$knots\n# hist(y[[4]], main=\"delta = 0.95\")\n\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n\n# testing out the MCMC\n# sigma1 = 0.7858, sigma3 = 2.1346\n# z11 = 0.3614, z13 = 0.6151\nfit1 <- mcmc(y=y[[1]], s=s, x=x, thresh=0, nknots=1,\n             iters=10000, burn=5000, update=1000, iterplot=T,\n             beta.init=beta.t, sigma.init=sigma.t[[1]], rho.init=rho.t,\n             nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t[1],\n             debug=F, knots.init=knots.t[[1]], z.init=z.knots.t[[1]],\n             fixknots=F, fixz=F, fixbeta=T, fixsigma=F, \n             fixrho=T, fixnu=T, fixalpha=T, fixdelta=T)\n\n# sigma1 = 0.9109, sigma3 = 1.2974\n# z11 = 0.8964, z13 = 0.8644\nfit2 <- mcmc(y=y[[2]], s=s, x=x, thresh=0, nknots=1,\n             iters=10000, burn=5000, update=1000, iterplot=T,\n             beta.init=beta.t, sigma.init=sigma.t[[2]], rho.init=rho.t,\n             nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t[2],\n             debug=F, knots.init=knots.t[[2]], z.init=z.knots.t[[2]],\n             fixknots=T, fixz=T, fixbeta=T, fixsigma=T, \n             fixrho=T, fixnu=T, fixalpha=T, fixdelta=F)\n\n# sigma1 = 1.4812, sigma3 = 0.7718\n# z11 = 1.1067, z13 = 0.3671\nfit3 <- mcmc(y=y[[3]], s=s, x=x, thresh=0, nknots=1,\n             iters=10000, burn=5000, update=1000, iterplot=T,\n             beta.init=beta.t, sigma.init=sigma.t[[3]], rho.init=rho.t,\n             nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t[3],\n             debug=F, knots.init=knots.t[[3]], z.init=z.knots.t[[3]],\n             fixknots=T, fixz=T, fixbeta=T, fixsigma=T, \n             fixrho=T, fixnu=T, fixalpha=T, fixdelta=F)\n\n# sigma1 = 2.2898, sigma3 = 0.5745\n# z11 = 1.4383, z13 = 0.5165\nfit4 <- mcmc(y=y[[4]], s=s, x=x, thresh=0, nknots=1,\n             iters=10000, burn=5000, update=1000, iterplot=T,\n             beta.init=beta.t, sigma.init=sigma.t[[4]], rho.init=rho.t,\n             nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t[4],\n             debug=F, knots.init=knots.t[[4]], z.init=z.knots.t[[4]],\n             fixknots=T, fixz=T, fixbeta=T, fixsigma=T, \n             fixrho=T, fixnu=T, fixalpha=T, fixdelta=F)\n \n \n# testing this out from simple to complicated                   \nrm(list=ls())\n\nlibrary(fields)\nlibrary(geoR)\nlibrary(mvtnorm)\nlibrary(evd)\n\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n\nset.seed(2087)\n\n# iid n(0, 1)\n# data settings\ns <- cbind(runif(50), runif(50))\nns <- nrow(s)\nnt <- 30\nnsets <- 1\nnknots <- 1\n\nx <- array(1, c(ns, nt, 3))\nfor (t in 1:nt) {\n    x[, t, 2] <- s[, 1]\n    x[, t, 3] <- s[, 2]\n}\n\nbeta.t <- c(0, 0, 0)\nrho.t <- 0.1\nnu.t <- 0.5\ndelta.t <- 0\nsigma.t <- rep(1, nt)\nalpha.t <- 0\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t, delta=delta.t,\n                    rho=rho.t, nu=nu.t, alpha=alpha.t, nknots=1)\n\ny <- data$y\nz.knots.t <- data$z.knots\nz.sites.t <- data$z.sites\nknots.t <- data$knots\n\nfit <- mcmc(y=y, s=s, x=x, thresh=0, nknots=1,\n            iters=10000, burn=5000, update=1000, iterplot=T,\n            beta.init=beta.t, sigma.init=sigma.t, rho.init=rho.t,\n            nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t,\n            debug=F, knots.init=knots.t, z.init=z.knots.t,\n            fixknots=T, fixz=T, fixbeta=T, fixsigma=F, \n            fixrho=T, fixnu=T, fixalpha=T, fixdelta=T)\n# works pretty well\n\n\nrm(list=ls())\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n# iid n(0, sigma2)\n# data settings\nset.seed(2087)\ns <- cbind(runif(50), runif(50))\nns <- nrow(s)\nnt <- 30\nnsets <- 1\nnknots <- 1\n\nx <- array(1, c(ns, nt, 3))\nfor (t in 1:nt) {\n    x[, t, 2] <- s[, 1]\n    x[, t, 3] <- s[, 2]\n}\n\nbeta.t <- c(0, 0, 0)\nrho.t <- 0.1\nnu.t <- 0.5\ndelta.t <- 0\nsigma.t <- 1 / rgamma(nt, 1, 1)\nalpha.t <- 0\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t, delta=delta.t,\n                    rho=rho.t, nu=nu.t, alpha=alpha.t, nknots=1)\n\ny <- data$y\nz.knots.t <- data$z.knots\nz.sites.t <- data$z.sites\nknots.t <- data$knots\n\n# sigma1 = 0.8379, sigma3 = 23.7572\nfit <- mcmc(y=y, s=s, x=x, thresh=0, nknots=1,\n            iters=10000, burn=5000, update=1000, iterplot=T,\n            beta.init=beta.t, sigma.init=sigma.t, rho.init=rho.t,\n            nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t,\n            debug=F, knots.init=knots.t, z.init=z.knots.t,\n            fixknots=T, fixz=T, fixbeta=T, fixsigma=F, \n            fixrho=T, fixnu=T, fixalpha=T, fixdelta=T)\n# seems to work well now\n\n\nrm(list=ls())\nlibrary(fields)\nlibrary(geoR)\nlibrary(mvtnorm)\nlibrary(evd)\n\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n# data settings\nset.seed(2087)\ns <- cbind(runif(50), runif(50))\nns <- nrow(s)\nnt <- 30\nnsets <- 1\nnknots <- 1\n\nx <- array(1, c(ns, nt, 3))\nfor (t in 1:nt) {\n    x[, t, 2] <- s[, 1]\n    x[, t, 3] <- s[, 2]\n}\n\nbeta.t <- c(0, 0, 0)\nrho.t <- 0.1\nnu.t <- 0.5\ndelta.t <- 0\n# sigma.t <- 1 / rgamma(nt, 10, 10)\nsigma.t <- rep(5, nt)\nalpha.t <- 0.9\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t, delta=delta.t,\n                    rho=rho.t, nu=nu.t, alpha=alpha.t, nknots=1)\n\ny <- data$y\nz.knots.t <- data$z.knots\nz.sites.t <- data$z.sites\nknots.t <- data$knots\n\n# sigma1 = 0.8317, sigma3 = 1.5020\nfit <- mcmc(y=y, s=s, x=x, thresh=0, nknots=1,\n            iters=20000, burn=15000, update=1000, iterplot=T,\n            beta.init=beta.t, sigma.init=sigma.t, rho.init=rho.t,\n            nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t,\n            debug=F, knots.init=knots.t, z.init=z.knots.t,\n            fixknots=T, fixz=T, fixbeta=T, fixsigma=F, \n            fixrho=F, fixnu=F, fixalpha=F, fixdelta=T)\n# works alright\n\n              \nrm(list=ls())\n\nlibrary(fields)\nlibrary(geoR)\nlibrary(mvtnorm)\nlibrary(evd)\n\nsource(\"auxfunctions.R\")\nsource(\"mcmc.R\")\n\nset.seed(2087)\n\n# iid n(0, 1)\n# data settings\ns <- cbind(runif(50), runif(50))\nns <- nrow(s)\nnt <- 100\nnsets <- 1\nnknots <- 1\n\nx <- array(1, c(ns, nt, 3))\nfor (t in 1:nt) {\n    x[, t, 2] <- s[, 1]\n    x[, t, 3] <- s[, 2]\n}\n\nbeta.t <- c(0, 0, 0)\nrho.t <- 0.1\nnu.t <- 0.5\ndelta.t <- 0.5\nsigma.t <- rep(1, nt)\nalpha.t <- 0\n\ndata <- rpotspatial(nt=nt, s=s, x=x, beta=beta.t, sigma=sigma.t, delta=delta.t,\n                    rho=rho.t, nu=nu.t, alpha=alpha.t, nknots=1)\n\ny <- data$y\nz.knots.t <- data$z.knots\nz.sites.t <- data$z.sites\nknots.t <- data$knots\n# hist(y, breaks=30)\n\nfit <- mcmc(y=y, s=s, x=x, thresh=0, nknots=1,\n            iters=10000, burn=5000, update=1000, iterplot=T,\n            beta.init=beta.t, sigma.init=sigma.t, rho.init=rho.t,\n            nu.init=nu.t, alpha.init=alpha.t, delta.init=delta.t,\n            debug=F, knots.init=knots.t, z.init=z.knots.t,\n            fixknots=T, fixz=T, fixbeta=T, fixsigma=T, \n            fixrho=T, fixnu=T, fixalpha=T, fixdelta=F)",
    "created" : 1399815666828.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2121492569",
    "id" : "80962617",
    "lastKnownWriteTime" : 1399858143,
    "path" : "~/repos-git/extreme-value/pot/code/R/pottest.R",
    "project_path" : "pottest.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}