\documentclass[11pt]{article}
\usepackage{amssymb, amsthm, amsmath}
\usepackage{bm}
\usepackage{graphicx}
\usepackage[authoryear]{natbib}
\usepackage{bm}
\usepackage{verbatim}
\usepackage{lineno}
\usepackage{times}
\usepackage{soul}
\usepackage{color}

\usepackage[left=1in,top=1in,right=1in]{geometry}
\pdfpageheight 11in
\pdfpagewidth 8.5in
\linespread{1.0}
\input{mycommands.sty}


\begin{document}\linenumbers

\begin{center}
{\Large {\bf A new spatial model for points above a threshold}}\\
\today
\end{center}

\section{Introduction}\label{s:intro}

\section{Statistical model}\label{s:model}

Let $Y_t(\bs)\in \calR$ be the observed value at location $\bs$ on day $t$.  To avoid bias in estimating tail parameters, we model the thresholded data
\beq\label{Yt}
  \Yt_t(\bs) = \left\{
          \begin{array}{ll}
            Y_t(\bs) & Y_t(\bs)>T \\
            T & Y_t(\bs)\le T
          \end{array}
        \right.
\eeq
where $T$ is a pre-specified threshold.   

We first specify a model for the complete data, $Y_t(\bs)$, and then study the induced model for thresholded data, $\Yt_t(\bs)$.  
The full data model is given in Section \ref{s:model} assuming a multivariate normal distribution with a different variance each day.
Computationally, the values below the threshold are updated using standard Bayesian missing data methods as described in Section \ref{s:comp}.

\subsection{Complete data}\label{s:model}
Consider the spatial process
\begin{align} \label{eq:fullmodel}
  Y_t(\bs) &= X_t(\bs) \beta + e_t(\bs)\\
  e_t(\bs) &= \sigma \delta | u_t(\bs) | + v_t(\bs)
\end{align}
where $u_t(\bs) = u_{tl}$ if $s \in P_{tl}$ where $P_{t1}, \ldots, P_{tL}$ form a partition, and $u_{tl} \iid N(0, 1)$, $\delta \in (-1, 1)$ controls skew, and $v_t(\bs)$ is a spatial process with mean zero and variance $\sigma^2(1 - \delta^2)$.
Then $Y_t(\bs)$ is skew normal within each partition \citep{Minozzo2012}.
We model this with a Bayesian hierarchical model as follows.
Let $w_{t1}, \ldots, w_{tL}$ be partition centers so that $P_{tl}$ includes all spatial locations $\bs$ that are within the partition.
Then
\begin{align} \label{eq:hier}
    Y_t(\bs) \mid \Theta &= \mu_t(\bs) + v_t(\bs) \\
    \mu_t(\bs) &= X_t(\bs) \beta + \sigma \delta | u_{tl} |
\end{align}
where $l = \argmin_j ||\bs - w_j ||$ and $\Theta = \{ u_{t1}, \ldots, u_{tL}, w_{t1}, \ldots, w_{tL}, \beta, \rho, \nu, \sigma \}$ are the random effects, knot locations, and parameters for the mean, and spatial covariance.

\section{Computation}\label{s:comp}
The MCMC for this model is fairly straightforward.
First, we impute values below the threshold.
Then, we update $\Theta$ using random walk MH or Gibbs sampling when appropriate.
Finally, we make spatial predictions.
Each requires the joint distribution for the complete data given $\Theta$.
As defined in \ref{eq:hier}, the distribution of $Y_t(\bs) \mid \Theta$ is the usual multivariate normal distribution with a \Matern spatial covariance structure.

\subsection{Imputation}\label{s:impute}
We can use Gibbs sampling to update $\Yt_t(\bs)$ for observations that are below $T$, the thresholded value. Given $\Theta$, $Y_t(\bs)$ has truncated normal full conditional with these parameter values.
So we sample $Y_t(\bs) \sim \text{TN}_{(-\infty, T)}$

\subsection{Parameter updates}\label{s:params}
To update $\Theta$ given the current value of the complete data $\bY_1, \ldots, \bY_T$, we use a standard Gibbs updates for all parameters except for the knot locations which are done using a Metropolis update.
See Appendix A.1 for details regarding Gibbs sampling and $|u_t(\bs)|$.

\subsection{Spatial prediction}\label{s:pred}
Given $\bY_t$ the usual Kriging equations give the predictive distribution for $Y_t(\bs^*)$ at prediction location $(\bs^*)$


\section{Data analysis}\label{s:analysis}


\section{Conclusions}\label{s:con}

\section*{Acknowledgments}

\section*{Appendix A.1: Posterior distributions}
\input{halfnormal.tex}
\input{betapost.tex}

\section*{Appendix A.2: MCMC Details}

\subsection*{Priors}



\bibliographystyle{rss}
\bibliography{Schlather}

\end{document}

