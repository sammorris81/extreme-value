library(fields)
library(SpatialTools)
options(warn=2)

#### Load simdata
rm(list=ls())
load(file='./simdataTS.RData')
source('../../R/mcmc.R', chdir=T)
source('../../R/auxfunctions.R')

iters <- 20000; burn <- 10000; update <- 1000; thin <- 1
nsets <- 5

fit.1 <- fit.2 <- fit.3 <- fit.4 <- vector(mode="list", length=nsets)
y.validate <- array(NA, dim=c(ntest, nt, nsets, 4))
start <- proc.time()
for (setting in 1:4) {
  for (d in 1:nsets) {
    y.d <- y[, , d, setting]
    obs <- c(rep(T, 100), rep(F, 44))
    y.o <- y.d[obs, ]
    x.o <- x[obs, , ]
    s.o <- s[obs, ]

    y.validate[, , d, setting] <- y.d[!obs, ]
    x.p <- x[!obs, , ]
    s.p <- s[!obs, ]

    if (setting == 1) {
      fit.1[[d]] <- mcmc(y=y.o, s=s.o, x=x.o, s.pred=s.p, x.pred=x.p,
                         method="t", skew=F, thresh.all=0, thresh.quant=T,
                         nknots=1, iterplot=T, iters=iters, burn=burn,
                         update=100, thin=thin, rho.upper=15, nu.upper=10,
                         temporaltau=FALSE, temporalw=TRUE, temporalz=F)
    }
  }
}